const _=require('./lodash');
const moment=require('./moment');
const CryptoJS=require('./aes');


!function(n,t,r){"undefined"!=typeof module&&module.exports?module.exports=r():"function"==typeof define&&define.amd?define(r):t.util=r()}(0,this,function(){"use strict";var r,e,t,i,u,o,a={};a.version="1.0.78",a.ls=(e="localStorage",t="creatoo.",i=function(n){return t+n},u=function(){try{var n=e in window&&null!==window[e],t=i("__"+Math.round(1e7*Math.random()));return n&&((r=window[e]).setItem(t,""),r.removeItem(t)),n}catch(n){return!1}}(),{get:function(n){if(!u)return null;var t=r?r.getItem(i(n)):null;return t&&"null"!==t?a.isJson(t)?JSON.parse(t):t:null},set:function(n,t){u&&(t?"string"!=typeof t&&(t=JSON.stringify(t)):t=null,r&&r.setItem(i(n),t))},remove:o=function(n){(u||r)&&r.removeItem(i(n))},clear:function(){if(u||r)for(var n in r)0===n.indexOf(t)&&o(n.substr(t.length))}}),a.cookie=function(){function r(n){var t,r=new RegExp("(^| )"+n+"=([^;]*)(;|$)");if(null===(t=document.cookie.match(r)))return null;var e=t[2];return e?a.isJson(e)?JSON.parse(e):e:null}return{get:r,set:function(n,t,r){var e=new Date;e.setDate(e.getDate()+r),t?"string"!=typeof t&&(t=JSON.stringify(t)):t=null,document.cookie=n+"="+t+(null===r?"":";path=/;expires="+e.toGMTString())},remove:function(n){var t=new Date;t.setTime(t.getTime()-1),null!==r(n)&&(document.cookie=n+"={};path=/;expires="+t.toGMTString())}}}(),a.chunk=function(n,t){return _.chunk(n,t)},a.clone=function(n){return _.cloneDeep(n)},a.drop=function(n,t){return _.drop(n,t)},a.dropRight=function(n,t){return _.dropRight(n,t)},a.xor=function(){var n=[];return[].push.apply(n,arguments),n.push(_.isEqual),_.xorWith.apply(_.xorWith,n)},a.notIn=function(){var n=[];return[].push.apply(n,arguments),n.push(_.isEqual),_.differenceWith.apply(_.differenceWith,n)},a.concat=function(){var n=arguments;return _.concat.apply(_.concat,n)},a.compact=function(n){return _.compact(n)},a.flatten=function(n){return _.flatten(n)},a.map=function(n,t){return _.map(n,t)},a.uniq=function(n){return n&&Array.isArray(n)&&0!=n.length?_.isPlainObject(n[0])?_.uniqWith(n,_.isEqual):_.uniq(n):[]},a.indexOf=function(n,t){return _.indexOf(n,t)},a.findIndex=function(n,t){return _.findIndex(n,t)},a.findOne=function(n,t){return _.find(n,t)},a.find=function(r,n){if(!Array.isArray(r))return[];if(!n||!_.isObject(n))return r;if(_.isPlainObject(n))return _.filter(r,n);var e=[];return(n=_.uniqWith(n,_.isEqual)).forEach(function(n){var t=_.filter(r,n);e=e.concat(t)}),e},a.max=function(n,t){return _.maxBy(n,t)},a.min=function(n,t){return _.minBy(n,t)},a.sort=function(n,t){return _.sortBy(n,t)},a.kv=function(n,t){return _.keyBy(n,t)},a.isInt=function(n){return _.isInteger(n)},a.isNumber=function(n){return _.isNumber(n)},a.random=function(n,t){return _.random(n,t)},a.round=function(n,t){return _.round(n,t)},a.toInt=function(n){if(!n)return 0;var t=_.toInteger(n);return _.isNaN(t)?0:t},a.toNumber=function(n){if(!n)return 0;var t=_.toNumber(n);return _.isNaN(t)?0:t},a.formatMoney=function(n){return(n=a.toNumber(n)).toFixed(2).toString()},a.isString=function(n){return null!=n&&"string"==typeof n},a.trim=function(n){return _.trim(n)},a.formatIp=function(n){if(!n)return"";var t=/([0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3})/.exec(n);return t&&0!==t.length?t[1]:""},a.format=function(n){if("string"!=typeof n)throw new Error("util.format(f),the f data type must be string.");var t=1,r=[];[].push.apply(r,arguments);var e=r.length;return n.replace(/%[s]/g,function(n){return e<=t?n:r[t++]})},a.stringify=function(n){var t=[];for(var r in n){var e=n[r]||"";"object"==typeof e&&(e=JSON.stringify(e)),e=a.encodeUrl(e),t.push(a.format("%s=%s",r,e))}return t.join("&")},a.qs=function(n){var t=new RegExp("(^|&)"+n+"=([^&]*)(&|$)","i"),r=window.location.search.substr(1).match(t);return null!=r?a.decodeUrl(r[2]):""},a.toText=function(n,t){return n?(n=(n=(n=(n=(n=(n=(n=(n=(n=n.replace(/\r/g," ")).replace(/\t/g," ")).replace(/\n/g," ")).replace(/&nbsp;/gi," ")).replace(/&ldquo;/gi,"“")).replace(/&rdquo;/gi,"”")).replace(/&[#0-9a-z]{1,7};/gi,"")).replace(/( )+/g," ")).replace(/<[^>]*>/gi,""),t&&0<t?n.length<=t?n:n.substr(0,t):n):""},a.decodeUrl=function(n){try{return decodeURIComponent(n)}catch(n){return""}},a.encodeUrl=function(n){return encodeURIComponent(n)},a.is=function(n,t){return _.isEqual(n,t)},a.isObject=function(n){return _.isObject(n)},a.isPlainObject=function(n){return _.isPlainObject(n)},a.isJson=function(n){if(!n)return!1;if(!a.isString(n))return!1;var t=a.trim(n);return/^(\[[\w\W]*\]|\{[\w\W]*\})$/.test(t)},a.isNullObj=function(n){if(!n)return!0;if(!a.isPlainObject(n))throw new Error("this obj is not PlainObject");return 0==Object.keys(n).length},a.extend=function(){var n=arguments;return _.assignIn.apply(_.assignIn,n)},a.merge=function(){var n=[];[].push.apply(n,arguments);return n.unshift({}),a.extend.apply(a.extend,n)},a.sortObj=function(t){if(null==t||null==t)return"";if(Array.isArray(t)){var r=[];return _.forEach(t,function(n){Array.isArray(n)||"object"==typeof n?r.push(a.sortObj(n)):r.push(n.toString())}),r}if("object"!=typeof t)return t.toString();var e={},n=_.sortBy(_.keys(t));return _.forEach(n,function(n){e[n]=a.sortObj(t[n])}),e},a.signObj=function(n){if(!n||Array.isArray(n)||"object"!=typeof n)return n;n._key=c;var t=a.sortObj(n);return t._sign=a.md5(JSON.stringify(t)),delete t._key,delete n._key,t},a.checkSign=function(n){var t=util.clone(n),r=t._sign;return!!r&&(delete t._sign,r===a.signObj(t)._sign)},a.formatObj=function(n){return a.isNullObj(n)?null:n},a.toDate=function(n){if(!n)return null;var t=moment(n);return"Invalid Date"==t?null:t.toDate()},a.getTimeByObjectId=function(n){if(!n)return 0;var t="";if(24!==(t="object"==typeof n?n.toString():n).length)return 0;var r=a.toDate(1e3*parseInt(t.substring(0,8),16));return r?r.getTime():0},a.isDate=function(n){return!!n&&"Invalid Date"!=moment(n)},a.formatDate=function(n,t){return n=n||new Date,(n=a.toDate(n))?(t=t||"YYYY-MM-DD",moment(n).format(t)):"Invalid Date"},a.dayTime=function(n,t){return n||(n=new Date),n=a.formatDate(n,"YYYY-MM-DD 00:00:00"),(n=a.toDate(n))?(t||n.getTime(),a.addDay(n,t)):0},a.addDate=function(n,t,r){return moment(n).add(r,t).valueOf()},a.addSecond=function(n,t){return a.addDate(n,"seconds",t)},a.addMinute=function(n,t){return a.addDate(n,"minutes",t)},a.addHour=function(n,t){return a.addDate(n,"hours",t)},a.addDay=function(n,t){return a.addDate(n,"days",t)};var c="d7f6822a8a52a4c4";return a.md5=function(n,t){var r=CryptoJS.MD5(n).toString();return 16==t?r&&32==r.length?r.substr(8,16):"":r},a.aesEncode=function(n,t){if(!n)return"";if((t=t||c).length<16)throw Error("the key length can't less than 16");return t=t.slice(-16),t=CryptoJS.enc.Utf8.parse(t),CryptoJS.AES.encrypt(n,t,{iv:t}).ciphertext.toString()},a.aesDecode=function(n,t){if((t=t||c).length<16)throw Error("the key length can't less than 16");t=t.slice(-16),t=CryptoJS.enc.Utf8.parse(t);var r=CryptoJS.enc.Hex.parse(n),e=CryptoJS.enc.Base64.stringify(r);return CryptoJS.AES.decrypt(e,t,{iv:t}).toString(CryptoJS.enc.Utf8)},a.bid=function(){return new Promise(function(r,n){(new Fingerprint2).get(function(n,t){r(n)})})},a});